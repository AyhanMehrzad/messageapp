{"version":3,"file":"static/js/861.336f3a82.chunk.js","mappings":"wJAEA,MA8EA,EA9EwBA,IAAqB,IAApB,WAAEC,GAAYD,EACnC,MAAOE,EAAWC,IAAgBC,EAAAA,EAAAA,WAAS,IAE3CC,EAAAA,EAAAA,WAAU,KAEaC,aAAaC,QAAQ,0BAIpCN,IAFAE,GAAa,IAIlB,CAACF,IAyBJ,OAAKC,GAGDM,EAAAA,EAAAA,KAAA,OAAKC,UAAU,qBAAoBC,UAC/BC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,mBAAkBC,SAAA,EAC7BF,EAAAA,EAAAA,KAAA,MAAIC,UAAU,aAAYC,SAAC,0BAC3BF,EAAAA,EAAAA,KAAA,KAAGC,UAAU,YAAWC,SAAC,mIAIzBC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,YAAWC,SAAC,kBAC3BC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,YAAWC,SAAC,mBAC5BF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,cAAaC,SAAC,6DAItCC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,YAAWC,SAAC,kBAC3BC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,YAAWC,SAAC,uBAC5BF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,cAAaC,SAAC,oDAItCC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,OAAKC,UAAU,YAAWC,SAAC,kBAC3BC,EAAAA,EAAAA,MAAA,OAAKF,UAAU,YAAWC,SAAA,EACtBF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,YAAWC,SAAC,mBAC5BF,EAAAA,EAAAA,KAAA,QAAMC,UAAU,cAAaC,SAAC,+DAK1CF,EAAAA,EAAAA,KAAA,UAAQC,UAAU,YAAYG,QA3DtBC,UAChB,UAEUC,UAAUC,aAAaC,aAAa,CAAEC,OAAO,EAAMC,OAAO,IAG5D,iBAAkBC,cACZC,aAAaC,oBAIvBf,aAAagB,QAAQ,yBAA0B,QAG/CnB,GAAa,GACbF,GACJ,CAAE,MAAOsB,GACLC,QAAQC,MAAM,8BAA+BF,GAC7CG,MAAM,+EAEV,GAuC2DhB,SAAC,2BApCzC,K","sources":["components/PermissionModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst PermissionModal = ({ onComplete }) => {\n    const [isVisible, setIsVisible] = useState(false);\n\n    useEffect(() => {\n        // Check local storage for permission grant (v2 key to force re-prompt after update)\n        const hasGranted = localStorage.getItem('permissions_granted_v2');\n        if (!hasGranted) {\n            setIsVisible(true);\n        } else {\n            onComplete();\n        }\n    }, [onComplete]);\n\n    const handleGrant = async () => {\n        try {\n            // 1. Request Media Permissions\n            await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n\n            // 2. Request Notification Permission\n            if (\"Notification\" in window) {\n                await Notification.requestPermission();\n            }\n\n            // Cache the result\n            localStorage.setItem('permissions_granted_v2', 'true');\n\n            // Close modal\n            setIsVisible(false);\n            onComplete();\n        } catch (err) {\n            console.error(\"Permission denied or error:\", err);\n            alert(\"Permissions are required to use this app. Please allow access when prompted.\");\n            // Do not close the modal on error, force retry or manual fix\n        }\n    };\n\n    if (!isVisible) return null;\n\n    return (\n        <div className=\"permission-overlay\">\n            <div className=\"permission-modal\">\n                <h2 className=\"perm-title\">Permissions Required</h2>\n                <p className=\"perm-desc\">\n                    To enable secure calls and file sharing, the app needs access to your device's camera, microphone, and notification services.\n                </p>\n\n                <div className=\"perm-list\">\n                    <div className=\"perm-item\">\n                        <div className=\"perm-icon\">ðŸ“·</div>\n                        <div className=\"perm-info\">\n                            <span className=\"perm-name\">Camera Access</span>\n                            <span className=\"perm-detail\">For making secure video calls and sending photos.</span>\n                        </div>\n                    </div>\n\n                    <div className=\"perm-item\">\n                        <div className=\"perm-icon\">ðŸŽ¤</div>\n                        <div className=\"perm-info\">\n                            <span className=\"perm-name\">Microphone Access</span>\n                            <span className=\"perm-detail\">For making secure voice and video calls.</span>\n                        </div>\n                    </div>\n\n                    <div className=\"perm-item\">\n                        <div className=\"perm-icon\">ðŸ””</div>\n                        <div className=\"perm-info\">\n                            <span className=\"perm-name\">Notifications</span>\n                            <span className=\"perm-detail\">To receive alerts when you get a secure message.</span>\n                        </div>\n                    </div>\n                </div>\n\n                <button className=\"btn-grant\" onClick={handleGrant}>Grant Permissions</button>\n            </div>\n        </div>\n    );\n};\n\nexport default PermissionModal;\n"],"names":["_ref","onComplete","isVisible","setIsVisible","useState","useEffect","localStorage","getItem","_jsx","className","children","_jsxs","onClick","async","navigator","mediaDevices","getUserMedia","video","audio","window","Notification","requestPermission","setItem","err","console","error","alert"],"ignoreList":[],"sourceRoot":""}